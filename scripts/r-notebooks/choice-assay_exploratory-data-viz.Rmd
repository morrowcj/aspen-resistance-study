---
title: "Choice Assay Exploratory Data Visualization"
output:
  html_document:
    df_print: paged
    toc_float: "yes"
    code_folding: "hide"
---

# Intro

This document is where I will conduct preliminary data visualization and analysis for the choice assay experiment.

# Setup

```{r setup, include = FALSE}
# getwd() 
knitr::opts_knit$set(root.dir = normalizePath("../.."))  # should change the working directory to the containing dir.
# getwd()  # returns correct. dir
knitr::opts_knit$get("root.dir")  # returns 'Users/Me/Docs/Proj'
```

```{bash, include=FALSE}
#bash scripts/update-data.sh
```

load R libraries:

```{r libraries, message=TRUE, warning=TRUE, include=FALSE}
library(ggplot2)
library(dplyr)
library(data.table)
library(car)
```

Define functions:

```{r functions}
# function to provide linear equation from a model. 
lm_eqtn <- function(model,x=NULL){
  ## extract model parameters
  incpt <- coef(model)[1]
  slope <- coef(model)[2]
  summ <- summary(model)
  r.sqr <- summ$r.squared
  adj.r.sqr <- summ$ajd.r.squared
  
  ## if x is not provided, print the equation as text
  if(is.null(x)){
    equation <- paste0("y=",round(slope,3),"*x+(",round(incpt,3),"); r^2=",round(r.sqr,4))
    return(noquote(equation))
  ## if x is given, calculate the predicted value
  } else {
    y <- as.vector((x*slope)+incpt)
    return(y)
  }
}

# lm_eqtn(model)
```

# Data exploration

load in the data:

```{r load data}
# load data
## read in L4 calibration data
larv.calib.data <- read.csv("data/Choice_Assay/larval-calibration-data_L4.csv")
## read in larval calibration data
leaf.calib.data <- read.csv("data/Choice_Assay/leaf-calibration-data.csv")
## read in experiment data
choice.assay.data <- read.csv("data/Choice_Assay/leaf-and-larvae-data_long.csv")
## redifine the class of specific columns
choice.assay.data <- within(choice.assay.data,{
  genet.lf <- as.factor(genet.lf)
})
leaf.calib.data <- within(leaf.calib.data,{
  Genet <- as.factor(Genet)
  group <- as.factor(group)
})

```

## Larval Calibration

define larval calibration model:

```{r larval calibration model}
# declare linear model for larval calibration (wet-dry mass)
larv.calib.model <- lm(larv.calib.data,formula = drymass_mg~wetmass_mg)

# plot dry~wet mass
ggplot(data = larv.calib.data, aes(y = drymass_mg, x = wetmass_mg))+
  geom_point() + #add points to the plot
  stat_smooth(method = "lm") +  #add a trendline
  labs(title = "choice assay larval calibration curve")+
  annotate("text",label = lm_eqtn(larv.calib.model),x = 60, y = 14)
  

# summarize model (R^2)
# summary(larv.calib.model)$r.squared
```

This calibration should work perfectly. The line fits the data well.

Calculate larval drymass:

```{r calculate larval drymass}
# calculate the estimated drymasses
choice.assay.data$gm.init.drymass_mg <- lm_eqtn(larv.calib.model, choice.assay.data$gm.init.wetmass_mg)

# visualize this new variable:
# plot(choice.assay.data$gm.init.drymass_mg~choice.assay.data$gm.init.wetmass_mg)
```

## Leaf Calibration

### Linear cal. method

First, we'll try the linear calibration model for leaf wet-dry mass:

```{r leaf cal. linear}
# declare linear model for leaf calibration (wet-dry mass)
leaf.calib.model <- lm(leaf.calib.data,formula = agg.drymass_mg~agg.wetmass_mg + group)

# plot dry~wet mass
ggplot(data = leaf.calib.data, aes(y = agg.drymass_mg, x = agg.wetmass_mg))+
  labs(title = "choice assay leaf calibration curve")+
  geom_point(aes(col=group)) + #add points to the plot
  stat_smooth(method = "lm") +  #add a trendline
  annotate("text",label = lm_eqtn(leaf.calib.model,x=NULL),x = 750, y = 550)
  
# summarize model (R^2)
summary(leaf.calib.model)$r.squared

# summary(lm(leaf.calib.data[-49,],formula = agg.drymass_mg~agg.wetmass_mg))$r.squared
```

Because there is substantial variation in drymass/wetmass, I decided to look at the coeficients separated by growth category (group):

### Grouped cal. method

```{r leaf cal. by group}
cat("anova table:\n")
anova(leaf.calib.model)

## look at the model coefficients by group
  ## library(data.table) allows the following
dat.tab <- data.table(leaf.calib.data)
coef.tab <- dat.tab[,list(intcpt = coef(lm(agg.drymass_mg ~ agg.wetmass_mg))[1],
                          slope = coef(lm(agg.drymass_mg ~ agg.wetmass_mg))[2],
                          r.sqr = summary(lm(agg.drymass_mg ~ agg.wetmass_mg))$r.squared),
              by = group]

ggplot(data = leaf.calib.data, 
       aes(y = agg.drymass_mg, 
           x = agg.wetmass_mg, 
           group = group)) +
  labs(title = "Wet-dry leaf calibration model",xlab = "aggregate wet mass (mg)", ylab = "aggregate dry mass (mg)") +     
  geom_point(aes(col = group)) + #add points to the plot
  stat_smooth(method = "lm", aes(col = group)) #add a trendline

cat("linear model parameters by group:\n")
within(coef.tab,{
  r.sqr <-  round(r.sqr,4)
  slope <-  round(slope,4)
  intcpt <-  round(intcpt,4)
})
  
```


There seems to be a significant effect of group on water loss.

#### Outlier testing

There may be an outlier in the calibration data:

```{r leaf cal. by group no outliers, eval=FALSE, echo=TRUE}
cat("outlier test:\n")
outlierTest(leaf.calib.model)
cal.outliers <- as.numeric(names(outlierTest(leaf.calib.model)[[1]]))

leaf.calib.model2 <- lm(leaf.calib.data[-cal.outliers],formula = agg.drymass_mg~agg.wetmass_mg + group)

cat("anova of model without outlier:\n")
anova(leaf.calib.model2)

## look at the model coefficients by group
dat.tab2 <- data.table(leaf.calib.data[-cal.outliers,])
coef.tab2 <- dat.tab2[,list(intcpt = coef(lm(agg.drymass_mg ~ agg.wetmass_mg))[1],
                          slope = coef(lm(agg.drymass_mg ~ agg.wetmass_mg))[2],
                          r.sqr = summary(lm(agg.drymass_mg ~ agg.wetmass_mg))$r.squared),
              by = group]

ggplot(data = leaf.calib.data[-cal.outliers,], 
       aes(y = agg.drymass_mg, 
           x = agg.wetmass_mg, 
           group = group)) +
  labs(title = "Wet-dry leaf calibration model",xlab = "aggregate wet mass (mg)", ylab = "aggregate dry mass (mg)") +     
  geom_point(aes(col = group)) + #add points to the plot
  stat_smooth(method = "lm", aes(col = group)) #add a trendline


cat("grouped model parameters (outlier removed):\n")
within(coef.tab2,{
  r.sqr <-  round(r.sqr,4)
  slope <-  round(slope,4)
  intcpt <-  round(intcpt,4)
})

```

Removing the potential outlier does not affect the curve enough to justify removing it. The full calibration data should be used.

The r-squared values are a bit better when grouped linear models are used over the traditional linear model, but it still may be best to use 1 correction factor per genotype (which is the average drymass/wetmass for 4-5 leaves per genet.)

```{r genet cal. key}
leaf.cal_lookup.tab <- leaf.calib.data %>% select(Genet,group,biomass.proportion_dry.div.wet) %>% group_by(Genet,group) %>% summarise(mean.biomass.prop=mean(biomass.proportion_dry.div.wet,na.rm = TRUE))

cat("subset of genet calibration table:\n")
head(leaf.cal_lookup.tab)
```

Here we merge in those genet-based calibration values:

```{r merge group cal. key}
# merge the lookup table into the choice assay data
choice.assay.data <- merge(choice.assay.data,leaf.cal_lookup.tab,by.x = "genet.lf",by.y = "Genet",all.x = TRUE)

# add in coeficients from grouped model
choice.assay.data <- merge(choice.assay.data,coef.tab,by = "group",all.x = TRUE)
```

Next I will estimate the initial dry mass according to the various calibration methods and then compare them:

### Calculate leaf drymass estimates

```{r initial dry mass calc.}
# calculate initial drymass

## full model
choice.assay.data$lf.init.drymass_no.calib_mg <- lm_eqtn(model = leaf.calib.model, choice.assay.data$lf.init.wetmass_mg)

choice.assay.data$bmass.consumed_no.cal <-  dif0 <- choice.assay.data$lf.init.drymass_no.calib_mg - choice.assay.data$lf.end.drymass_mg

prop0 <- length(which(dif0<0))/length(dif0)

## Genet method
choice.assay.data$lf.init.drymass_genet.calib_mg <- choice.assay.data$mean.biomass.prop*choice.assay.data$lf.init.wetmass_mg

choice.assay.data$bmass.consumed_genet.cal <- dif1 <- choice.assay.data$lf.init.drymass_genet.calib_mg - choice.assay.data$lf.end.drymass_mg

prop1 <- length(which(dif1<0))/length(dif1)

# group method
choice.assay.data$lf.init.drymass_group.calib_mg <- (choice.assay.data$lf.init.wetmass_mg*choice.assay.data$slope)+choice.assay.data$intcpt

choice.assay.data$bmass.consumed_group.cal <- dif2 <- choice.assay.data$lf.init.drymass_group.calib_mg - choice.assay.data$lf.end.drymass_mg

prop2 <- length(which(dif2<0))/length(dif2)

# Print a plot:

boxplot(dif0,dif1,dif2,names = c("linear","genet","grouped linear"),main = "Estimated Leaf Biomass Consumed \n by calibration method",ylab = "leaf biomass lost (mg)",xlab = "calibration type")
abline(h = 0, col = "grey", lty = 2)


# Print results:

cat("boxplot stats (full linear model):\n")
summary(dif0)

cat("boxplot stats (genet calibration):\n")
summary(dif1)

cat("boxplot stats (grouped linear model):\n")
summary(dif2)

```

The comparison shows that both linear methods estimate fewer observations with "leaf biomass lost" < 0.
Additionally, the grouped linear method estimates even less negative valuse than the original linear model: 

```{r prop. of obs. with neg. biomass lost}
round(cbind("linear" = prop0, "genet" = prop1, "grp.lin" = prop2),digits = 4)
```

#### Standardize some metrics by initial larval biomass

```{r linear model from data}
model <- with(choice.assay.data,{
  lm(lf.end.drymass_mg ~ lf.init.drymass_group.calib_mg + group + gm.init.drymass_mg)
  })

cat("anova table:\n")
anova(model)
```


```{r biomass consumed by larval mass, include = FALSE}
with(choice.assay.data,{
  plot(bmass.consumed_group.cal ~ gm.init.drymass_mg)
})
```

Before we look at potential outliers, we should standardize
some metrics by initial larval biomass:

```{r standardize by initial larval mass}
choice.assay.data <- within(choice.assay.data,{
  rel.bmass.cons_no.cal <- bmass.consumed_no.cal/gm.init.drymass_mg
  rel.bmass.cons_genet.cal <- bmass.consumed_genet.cal/gm.init.drymass_mg
  rel.bmass.cons_group.cal <- bmass.consumed_group.cal/gm.init.drymass_mg
})

barplot(sort(choice.assay.data$rel.bmass.cons_group.cal), 
        ylab = "Relative bio_mass consumed (mg/mg)",
        xlab = "Larva Index (sorted)",
        main = "Relative biomass consumed by GM larvae")
```

### No molting

First, I want to make sure that there isn't any obvious reason for a decrease in area.

```{r compare without molting}
data.reduced <- choice.assay.data[choice.assay.data$molting_bin<1,]

data.reduced$leaf.mass.consumed <- dif.red <- (data.reduced$lf.init.drymass_group.calib_mg - data.reduced$lf.end.drymass_mg)

prop.red <- length(which(dif.red < 0))/length(dif.red)

prop.genet.red <- length(which(data.reduced$bmass.consumed_genet.cal < 0))/length(data.reduced$bmass.consumed_genet.cal)

boxplot(dif0,dif1,dif2,dif.red,data.reduced$bmass.consumed_genet.cal,names = c("linear","genet","grouped\n linear", "no.molt\ngrouped","no.molt\n genet"),main = "Estimated Leaf Biomass Consumed \n by calibration method",ylab = "leaf biomass lost (mg)",xlab = "calibration type")
abline(h = 0, col = "grey", lty = 2)
```

```{r no molting prop}
round(cbind("linear" = prop0, "genet" = prop1, "grp.lin" = prop2, prop.red, prop.genet.red),digits = 4)
```

```{r prop. of molting}
length(which(choice.assay.data$molting_bin==1))/nrow(choice.assay.data)
```

### Check Data

```{r full data plot}
model <- lm(data = data.reduced, lf.end.drymass_mg ~ lf.init.drymass_group.calib_mg)

cat("original r-squared (with group covariate):\n")
summary(model)$r.squared

plot(data.reduced$lf.end.drymass_mg ~ data.reduced$lf.init.drymass_group.calib_mg,
     xlab = "initial leaf drymass (mg)",
     ylab = "final leaf drymass (mg)",
     main = "final leaf biomass by initial biomass (full data)"
     )
suppressWarnings(abline(model))
abline(c(0,1),col = "red")

```

```{r}
cons.model <- lm(data = data.reduced, bmass.consumed_group.cal ~ group + 
                   genet.lf + gm.init.drymass_mg)

cat("consumption model rsquared:\n")
summary(cons.model)$r.squared

anova(cons.model)

with(data.reduced,{
  boxplot(bmass.consumed_group.cal ~ group,
       xlab = "group",
       ylab = "biomass consumed (mg)",
       main = "biomass consumed by group")
  plot(bmass.consumed_group.cal ~ gm.init.drymass_mg,
       ylab = "biomass consumed (mg)",
       xlab = "initial GM biomass (mg)",
       main = "biomass consumed by initial larval biomass")
  abline(lm(bmass.consumed_group.cal ~ gm.init.drymass_mg),
         col = "red")
  plot(bmass.consumed_group.cal ~ genet.lf,
       ylab = "biomass consumed (mg)",
       xlab = "genet",
       main = "biomass consumed by leaf genet")
})
```


#### Outlier test:

There appears to be an outlier in the data (biomass consumed of about 150 mg)

We'll do an official outlier test here:

```{r lf. cal. outlier tests}

## from the 'car' package:
outlr.test <- outlierTest(cons.model,n.max = Inf)

cat("outlier test:\n")
outlr.test
  
if (outlr.test$bonf.p <= outlr.test$cutoff){
  # list of outliers (as rows of original dataset)
  outliers <- as.numeric(names(outlr.test[[1]]))
  
  outliers
  
  out.obs <- data.reduced[outliers,]
  
  out.obs %>% select("genet.lf","group","lf.init.drymass_group.calib_mg","lf.end.drymass_mg","bmass.consumed_group.cal", "rel.bmass.cons_group.cal")
  
  # Show the biomass difference
  outlier.val <- round(data.reduced[outliers, "lf.end.drymass_mg"],digits = 2)
  
  outlier.val
  
  rel.cons.outlier <- round(data.reduced$rel.bmass.cons_group.cal[outliers],3)
}
```

There is no official outlier, according to the bonferoni outlier test. However,
this value still seems unusual and may need to be removed.

This anamoly is likely due to a recording error in the leaf's mass. I will test to see the effect of removing the observations:

```{r outlier effect}
out.index <- which(data.reduced$bmass.consumed_group.cal >= 120)

cat("potential outlier:\n")
data.reduced[out.index,] %>% select("genet.lf","group","bmass.consumed_group.cal", "rel.bmass.cons_group.cal")

data.no.outlier <- data.reduced[-out.index,]

cons.model2 <- lm(data = data.no.outlier, bmass.consumed_group.cal ~ group + 
                   genet.lf + gm.init.drymass_mg)


cat("new r-squared (with group covariate):\n")
(new.rsqr <- summary(cons.model2)$r.squared)
cat("old rsquared:\n")
(old.rsqr <- summary(cons.model)$r.squared)

anova(cons.model2)

with(data.no.outlier,{
plot(bmass.consumed_group.cal ~ gm.init.drymass_mg,
       ylab = "biomass consumed (mg)",
       xlab = "initial GM biomass (mg)",
       main = "biomass consumed by initial larval biomass")
  abline(lm(bmass.consumed_group.cal ~ gm.init.drymass_mg), 
         col = "blue")
  abline(lm(data = data.reduced, bmass.consumed_group.cal ~ gm.init.drymass_mg), 
         col = "red", lty = 2)
  
})
if (old.rsqr >= new.rsqr){print("removing the observation(s) does not improve the model: r-squared did not improve.")}
```

There is no strong effect of removing observation `r out.index`, in fact, r-squared
decreases. Therefore, the value should remain for now.


## Visualization

```{r leaves per dish}
leaves <- data.reduced %>% group_by(Dish.ID) %>% summarise("leaves" = length(genet.lf))

data.reduced <- merge(data.reduced,leaves,by = "Dish.ID")
```

Here I'll add in the treatment group which is the combination of all groups
present in one dish.

```{r treatment group}
# create the empty key
treatment.key <- data.frame("Dish.ID" = data.reduced$Dish.ID, "treatment" = NA)

# loop over all dishes and extract the groups present
for (ID in data.reduced$Dish.ID){
  trts <- unique(data.reduced$group[which(data.reduced$Dish.ID == ID)])
  trts <- sort(trts)
  ## paste the dishes groups together into one string
  treatment <- paste(trts, collapse = ".")
  ## at the treatment string to the key
  treatment.key$treatment[which(treatment.key$Dish.ID == ID)] <- treatment
}

## check that there are only 4 treatments
stopifnot(length(unique(treatment.key$treatment))==4)
## if the IDs aren't equal, stop.
stopifnot(all.equal(treatment.key$Dish.ID,data.reduced$Dish.ID))
## same for number of observations
stopifnot(nrow(treatment.key) == nrow(data.reduced))

match.index <- match(x = treatment.key$Dish.ID, table = data.reduced$Dish.ID)

data.reduced$treatment <- factor(treatment.key$treatment,levels = unique(treatment.key$treatment))

data.reduced %>% nrow()

## show that it worked:
data.reduced[data.reduced$Dish.ID %in% data.reduced$Dish.ID[c(1,5,31,80)],] %>% select(Dish.ID, group, treatment)

## treatment composition table
(treatment.n <- data.reduced %>% group_by(treatment) %>% summarise("dish n" = length(unique(Dish.ID))))
```

### Plots

Let's see how our treatments influenced consumption:

```{r plot the groups, include=FALSE}
ggplot(data = data.reduced, aes(x = jitter(as.numeric(treatment)), y = leaf.mass.consumed, fill = group)) +
  geom_point(aes(col = group)) + labs(title = "leaf biomass consumed by treatment", y = "biomass consumed")

## summarize the grouped data by mean 
plot.table <- data.reduced %>% group_by(treatment, group) %>% summarize(mean.consumed = mean(leaf.mass.consumed), sd.consumed = sd(leaf.mass.consumed))


(gp <- ggplot(data = plot.table, aes(x = treatment, y = mean.consumed, fill = group)) +
  geom_bar(stat = "identity", position = "dodge", col = "black")+
    labs(title = "leaf biomass consumed by treatment", y = "biomass consumed")
  )
  
  
gp +geom_errorbar(aes(ymin = mean.consumed - sd.consumed,
                    ymax = mean.consumed + sd.consumed),
                width = .2,
                position = position_dodge(.9))
```

<!-- There is a potential outlier according to the first graph above. -->

```{r potential outlier, include=FALSE}
potential.outlier <- which(data.reduced$leaf.mass.consumed > 100)

cat("Dish.ID of potential outlier:\n")
(dish.outlier <- as.character(data.reduced[potential.outlier,"Dish.ID"]))
```

```{r redo the triplets without this outlier, include=FALSE}
triplets.filtered <- data.reduced %>% filter(! Dish.ID %in% dish.outlier, treatment == "fast.med.slow")

triplets.means <- triplets.filtered %>% group_by(group) %>% 
  summarise(mean.consumed = mean(leaf.mass.consumed), sd.consumed = sd(leaf.mass.consumed))

ggplot(data = triplets.means, aes(y = mean.consumed, x = group)) +
  geom_bar(aes(fill = group), stat = "identity", position = "dodge") + 
    labs(title = "leaf biomass consumed by treatment", subtitle = "(choice of all 3)", y = "biomass consumed") +
  geom_errorbar(aes(ymin = mean.consumed - sd.consumed,
                    ymax = mean.consumed + sd.consumed),
                width = .2,
                position = position_dodge(.9))
```

#### Again with relative consumption

```{r plot the groups (rel consumption)}

ggplot(data = data.reduced, aes(x = jitter(as.numeric(treatment)), y = rel.bmass.cons_group.cal, fill = group)) +
  geom_point(aes(col = group)) + labs(title = "relative consumption by treatment", y = "relative biomass consumed", x = "dish combination (jittered)")

## summarize the grouped data by mean 
plot.table <- data.reduced %>% 
  filter(! Dish.ID %in% dish.outlier) %>% ## this step only if outlier should be removed
  group_by(treatment, group) %>% 
  summarize(mean.consumed = mean(rel.bmass.cons_group.cal), 
            sd.consumed = sd(rel.bmass.cons_group.cal))


gp <- ggplot(data = plot.table, aes(x = treatment, y = mean.consumed, fill = group)) +
  geom_bar(stat = "identity", position = "dodge", col = "black")+
    labs(title = "relative consumption by treatment",subtitle = "(minus potential outlier in fast.med.slow)", y = "relative biomass consumed")
  
  
  
gp +geom_errorbar(aes(ymin = mean.consumed - sd.consumed,
                    ymax = mean.consumed + sd.consumed),
                width = .2,
                position = position_dodge(.9))

```

Let's test the significance of these relationships:

```{r significance}
fast.med <- data.reduced %>% 
  filter(! Dish.ID %in% dish.outlier) %>% ## this step only if outlier should be removed
  filter(treatment == "fast.med")
fast.med.model <- lm(data = fast.med, rel.bmass.cons_group.cal ~ group)


fast.slow <- data.reduced %>% 
  filter(! Dish.ID %in% dish.outlier) %>% ## this step only if outlier should be removed
  filter(treatment == "fast.slow")
fast.slow.model <- lm(data = fast.slow, rel.bmass.cons_group.cal ~ group)


med.slow <- data.reduced %>% 
  filter(! Dish.ID %in% dish.outlier) %>% ## this step only if outlier should be removed
  filter(treatment == "med.slow")
med.slow.model <- lm(data = med.slow, rel.bmass.cons_group.cal ~ group)


fast.med.slow <- data.reduced %>% 
  filter(! Dish.ID %in% dish.outlier) %>% ## this step only if outlier should be removed
  filter(treatment == "fast.med.slow")
fast.med.slow.model <- lm(data = fast.med.slow, rel.bmass.cons_group.cal ~ group)

fast.med.pval <- anova(fast.med.model)$`Pr(>F)`[1]
fast.slow.pval <- anova(fast.slow.model)$`Pr(>F)`[1]
med.slow.pval <- anova(med.slow.model)$`Pr(>F)`[1]
fast.med.slow.pval <- anova(fast.med.slow.model)$`Pr(>F)`[1]

cat("t-tests of pairs (H0 = means are equal):\n")
p.vals <- c("fast:med" = fast.med.pval, 
            "fast:slow" = fast.slow.pval, 
            "med:slow" = med.slow.pval)
sig.stars <- ifelse(p.vals <= .05, yes = "*",no = "")
as.data.frame(rbind(round(p.vals,4),sig.stars),row.names = c("p.vals", "p < .05"))

# summary(fast.med.slow.model)

## test for difference of variance (pooled or not)
leveneTest(y = fast.med.slow$rel.bmass.cons_group.cal, group = fast.med.slow$group)
  ## the p value of .064 is borderline but I will choose to not pool the SD
  ## because of the visual difference in the SD bars.

cat("parwise t-test for the triplets:\n")
## test for difference of mean
trip.test <- with(fast.med.slow,{
  pairwise.t.test(x = rel.bmass.cons_group.cal, g = group, pool.sd = FALSE)
})  

trip.test
cat("significance of pairwise t-test:\n")
noquote(ifelse(trip.test$p.value <= .05, yes = "*", no = "-"))
```

In conclusion (based on only significant results): 

1. In a choice between fast and slow-growing genets, larvae prefered fast growers

2. in a choice between moderate- and slow-growing genets, larvae prefered moderate growers

3. in a choice between all 3 groups, moderate-growing genets were prefered over fast growers.
**Note:** This is supported by the trend (non-significant) of larvae prefering moderate over fast genets in the first paired treatment.


# Needed

I still need to incoporate the elapsed feeding time (although all dishes were allowed to feed for approximately 24 hours)

```{r update data}
write.csv(choice.assay.data,file = "data/Choice_Assay/leaf-and-larvae-data_long_calibrated.csv")
```

